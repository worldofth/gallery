!function(){"use strict";function i(i){return new Promise(function(t,e){var s=function o(e){for(var s=0;s<z.length;s++)i.removeEventListener(z[s],o);t()};i||e("No element passed to on End Transition");for(var n=0;n<z.length;n++)i.addEventListener(z[n],s)})}function t(){var i=arguments;if(i.length<2)return i[0];for(var t=i[0],e=1;e<i.length;e++)if(i[e])for(var s in i[e])t[s]=i[e][s];return t}function e(){return new Promise(function(i,t){return requestAnimationFrame(i)})}function s(i,t){var e=Object.create(M);return e.setup(i,t),e.init(),e}function n(i,e){if(this.elClass=i,this.el=document.querySelector(i),this.el){this.options=t({},A,e),this.sizeIndex=a.call(this),this.items=Array.prototype.slice.call(this.el.querySelectorAll(".gallery__item")),this.previewEl=this.el.nextElementSibling,this.isExpanded=!1,this.isAnimating=!1,this.ticking=!1,this.closeBtn=this.previewEl.querySelector(".gallery__preview-close");var s=this.previewEl.querySelectorAll(".gallery__preview-description");this.previewDescriptionEl=s[0],this.emptyPreviewDescriptionEl=s[1],this.previousBtn=this.previewEl.querySelector(".gallery__preview-btn--previous"),this.nextBtn=this.previewEl.querySelector(".gallery__preview-btn--next"),this.openItem=this.openItem.bind(this),this.closeItem=this.closeItem.bind(this),this.nextItem=this.nextItem.bind(this),this.previousItem=this.previousItem.bind(this)}}function o(){if(this.el){var i=function(){this.bricks=k({container:this.elClass,packed:"data-packed",sizes:this.options.sizes}),this.bricks.resize(!0).pack(),this.el.classList.add("gallery--loaded"),r.call(this),m.call(this),u.call(this)};Promise.all(d.call(this)).then(i.bind(this))}}function r(){var i=this;this.items.forEach(function(t){t.querySelector(".gallery__image")&&t.addEventListener("click",function(e){e.preventDefault(),i.openItem(t)})}),this.closeBtn.addEventListener("click",this.closeItem),this.previousBtn.addEventListener("click",this.previousItem),this.nextBtn.addEventListener("click",this.nextItem),window.addEventListener("resize",l.bind(this)),window.addEventListener("keydown",function(i){"Escape"==i.key&&this.closeItem(),"ArrowRight"==i.key&&this.nextItem(),"ArrowLeft"==i.key&&this.previousItem()}.bind(this))}function a(){var i=this.options.imgPositions.map(function(i){return i.mq&&window.matchMedia("(min-width: "+i.mq+")").matches}).indexOf(!0);return~i?i:0}function l(){this.ticking||(requestAnimationFrame(h.bind(this)),this.ticking=!0)}function h(){var i=a.call(this);this.sizeIndex!==i&&(this.sizeIndex=i,m.call(this),this.isExpanded&&(this.originalImg.style.opacity=1)),this.ticking=!1}function c(t){if(!this.isAnimating&&!this.isExpanded){this.isAnimating=!0,this.isExpanded=!0,E.call(this,t);var e=t.querySelector("img"),s=e.getBoundingClientRect();this.current=this.items.indexOf(t),m.call(this,t.querySelector("a").getAttribute("href")),u.call(this,e.src,{width:e.offsetWidth,height:e.offsetHeight,left:s.left,top:s.top}),t.classList.add("gallery__item--current");var n=0;"undefined"!=typeof this.options.imgPositions[this.sizeIndex].pagemargin&&(n=this.options.imgPositions[this.sizeIndex].pagemargin);var o=b(),r=t.getAttribute("data-size").split("x"),a={width:r[0],height:r[1]},l=(this.options.imgPositions[this.sizeIndex].pos.x>0?1-Math.abs(this.options.imgPositions[this.sizeIndex].pos.x):Math.abs(this.options.imgPositions[this.sizeIndex].pos.x))*o.width+this.options.imgPositions[this.sizeIndex].pos.x*o.width/2-s.left-.5*e.offsetWidth,h=(this.options.imgPositions[this.sizeIndex].pos.y>0?1-Math.abs(this.options.imgPositions[this.sizeIndex].pos.y):Math.abs(this.options.imgPositions[this.sizeIndex].pos.y))*o.height+this.options.imgPositions[this.sizeIndex].pos.y*o.height/2-s.top-.5*e.offsetHeight,c=Math.min(Math.min(o.width*Math.abs(this.options.imgPositions[this.sizeIndex].pos.x)-n,a.width-n)/e.offsetWidth,Math.min(o.height*Math.abs(this.options.imgPositions[this.sizeIndex].pos.y)-n,a.height-n)/e.offsetHeight),g="translate3d("+l+"px, "+h+"px, 0) scale3d("+c+", "+c+", 1)";this.cloneImg.style.WebkitTransform=g,this.cloneImg.style.transform=g;var d=t.querySelector(".gallery__description");d&&(this.previewDescriptionEl.innerHTML=d.innerHTML);var f=this;setTimeout(function(){f.previewEl.classList.add("gallery__preview--open")},0),Promise.all([i(this.cloneImg),p.call(this)]).then(function(){f.originalImg.style.opacity=1}).then(function(){return i(f.originalImg)}).then(function(){f.cloneImg.style.opacity=0,f.cloneImg.style.WebkitTransform="translate3d(0,0,0) scale3d(1,1,1)",f.cloneImg.style.transform="translate3d(0,0,0) scale3d(1,1,1)",f.isAnimating=!1})["catch"](function(i){console.error(i)})}}function m(i){if(!i){this.originalImg=document.createElement("img"),this.originalImg.className="gallery__preview-original",this.originalImg.style.opacity=0;var t=0;"undefined"!=typeof this.options.imgPositions[this.sizeIndex].pagemargin&&(t=this.options.imgPositions[this.sizeIndex].pagemargin),this.originalImg.style.maxWidth="calc("+parseInt(100*Math.abs(this.options.imgPositions[this.sizeIndex].pos.x))+"vw - "+t+"px)",this.originalImg.style.maxHeight="calc("+parseInt(100*Math.abs(this.options.imgPositions[this.sizeIndex].pos.y))+"vh - "+t+"px)",this.originalImg.style.WebkitTransform="translate3d(0,0,0)",this.originalImg.style.transform="translate3d(0,0,0)",i="";var e=this.previewEl.querySelector("."+this.originalImg.className);e&&(i=e.src,e.remove()),this.previewEl.appendChild(this.originalImg)}this.originalImg.setAttribute("src",i)}function p(){return g(this.originalImg)}function g(i){var t=function(t,e){i.getAttribute("src")||e("no src found for original image");var s=function(){i.complete?t():e("image not loaded: "+i.getAttribute("src"))};i.complete?t():i.onload=s.bind(this)};return new Promise(t.bind(this))}function d(){return this.items.map(function(i){var t=i.querySelector("img");if(t)return g(t)})}function u(i,t){i?(this.cloneImg.style.opacity=1,this.cloneImg.style.width=t.width+"px",this.cloneImg.style.height=t.height+"px",this.cloneImg.style.top=t.top+"px",this.cloneImg.style.left=t.left+"px"):(this.cloneImg=document.createElement("img"),this.cloneImg.className="gallery__preview-clone",i="",this.cloneImg.style.opacity=0,this.previewEl.appendChild(this.cloneImg)),this.cloneImg.setAttribute("src",i)}function f(){if(this.isExpanded&&!this.isAnimating){this.isExpanded=!1,this.isAnimating=!0;var t=this.items[this.current],e=t.querySelector("img"),s=e.getBoundingClientRect(),n=this;this.previewEl.classList.remove("gallery__preview--open"),this.originalImg.classList.add("gallery__preview-original--animate");var o=b(),r=s.left+e.offsetWidth/2-((this.options.imgPositions[this.sizeIndex].pos.x>0?1-Math.abs(this.options.imgPositions[this.sizeIndex].pos.x):Math.abs(this.options.imgPositions[this.sizeIndex].pos.x))*o.width+this.options.imgPositions[this.sizeIndex].pos.x*o.width/2),a=s.top+e.offsetHeight/2-((this.options.imgPositions[this.sizeIndex].pos.y>0?1-Math.abs(this.options.imgPositions[this.sizeIndex].pos.y):Math.abs(this.options.imgPositions[this.sizeIndex].pos.y))*o.height+this.options.imgPositions[this.sizeIndex].pos.y*o.height/2),l=e.offsetWidth/this.originalImg.offsetWidth;this.originalImg.style.WebkitTransform="translate3d("+r+"px, "+a+"px, 0) scale3d("+l+", "+l+", 1)",this.originalImg.style.transform="translate3d("+r+"px, "+a+"px, 0) scale3d("+l+", "+l+", 1)",i(this.originalImg).then(function(){n.previewDescriptionEl.innerHTML="",t.classList.remove("gallery__item--current"),setTimeout(function(){n.originalImg.style.opacity=0},60)}).then(function(){return i(n.originalImg)}).then(function(){n.originalImg.classList.remove("gallery__preview-original--animate"),n.originalImg.style.WebkitTransform="translate3d(0,0,0) scale3d(1,1,1)",n.originalImg.style.transform="translate3d(0,0,0) scale3d(1,1,1)",n.isAnimating=!1})["catch"](function(i){console.error(i)})}}function y(){I.call(this,50,x)}function v(){I.call(this,-50,w)}function I(t,s){var n=this;if(this.isExpanded&&!this.isAnimating){var o=this.items[this.current],r=s(o);if(o&&r&&r.classList.contains("gallery__item")){this.isAnimating=!0,this.current=this.items.indexOf(r),o.classList.remove("gallery__item--current"),r.classList.add("gallery__item--current"),E.call(this,r);var a=r.querySelector("img"),l=a.getBoundingClientRect();u.call(this,a.src,{width:a.offsetWidth,height:a.offsetHeight,left:l.left,top:l.top});var h=0;"undefined"!=typeof this.options.imgPositions[this.sizeIndex].pagemargin&&(h=this.options.imgPositions[this.sizeIndex].pagemargin),t||(t=50);var c=b(),p=r.getAttribute("data-size").split("x"),d={width:p[0],height:p[1]},f=(this.options.imgPositions[this.sizeIndex].pos.x>0?1-Math.abs(this.options.imgPositions[this.sizeIndex].pos.x):Math.abs(this.options.imgPositions[this.sizeIndex].pos.x))*c.width+this.options.imgPositions[this.sizeIndex].pos.x*c.width/2-l.left-.5*a.offsetWidth,y=(this.options.imgPositions[this.sizeIndex].pos.y>0?1-Math.abs(this.options.imgPositions[this.sizeIndex].pos.y):Math.abs(this.options.imgPositions[this.sizeIndex].pos.y))*c.height+this.options.imgPositions[this.sizeIndex].pos.y*c.height/2-l.top-.5*a.offsetHeight,v=Math.min(Math.min(c.width*Math.abs(this.options.imgPositions[this.sizeIndex].pos.x)-h,d.width-h)/a.offsetWidth,Math.min(c.height*Math.abs(this.options.imgPositions[this.sizeIndex].pos.y)-h,d.height-h)/a.offsetHeight),I=f+t,x="translate3d("+I+"px, "+y+"px, 0) scale3d("+v+", "+v+", 1)";this.cloneImg.style.transition="none",this.cloneImg.style.WebkitTransform=x,this.cloneImg.style.transform=x;var w=r.querySelector(".gallery__description");if(w){this.emptyPreviewDescriptionEl.classList.add("gallery__preview-description--animate"),this.previewDescriptionEl.classList.add("gallery__preview-description--animate"),this.emptyPreviewDescriptionEl.innerHTML=w.innerHTML,this.emptyPreviewDescriptionEl.style.transition="none",this.emptyPreviewDescriptionEl.style.opacity=0;var P="translate3d(0, "+t+"px, 0)";this.emptyPreviewDescriptionEl.style.WebkitTransform=P,this.emptyPreviewDescriptionEl.style.transform=P}var _=this;e().then(function(){var i="translate3d(-"+t+"px, 0, 0)";_.originalImg.classList.add("gallery__preview-original--animate"),_.originalImg.style.opacity=0,_.originalImg.style.WebkitTransform=i,_.originalImg.style.transform=i,_.cloneImg.style.transition="";var e="translate3d("+f+"px, "+y+"px, 0) scale3d("+v+", "+v+", 1)";_.cloneImg.style.WebkitTransform=e,_.cloneImg.style.transform=e,_.cloneImg.style.opacity=1;var s="translate3d(0, -"+t+"px, 0)";_.previewDescriptionEl.style.opacity=0,_.previewDescriptionEl.style.WebkitTransform=s,_.previewDescriptionEl.style.transform=s,_.emptyPreviewDescriptionEl.style.transition="",_.emptyPreviewDescriptionEl.style.opacity=1;var n="translate3d(0, 0, 0)";_.emptyPreviewDescriptionEl.style.WebkitTransform=n,_.emptyPreviewDescriptionEl.style.transform=n;var o=_.previewDescriptionEl;_.previewDescriptionEl=_.emptyPreviewDescriptionEl,_.emptyPreviewDescriptionEl=o}).then(function(){return i(_.originalImg)}).then(function(){_.originalImg.classList.remove("gallery__preview-original--animate");var i="translate3d(0, 0, 0)";_.originalImg.style.WebkitTransform=i,_.originalImg.style.transform=i}).then(function(){return m.call(_,r.querySelector("a").getAttribute("href"))}).then(function(){return g.call(_,_.originalImg)}).then(function(){_.originalImg.style.transition="",_.originalImg.style.opacity=1}).then(function(){return i(_.originalImg)}).then(function(){_.cloneImg.style.opacity=0,_.cloneImg.style.WebkitTransform="translate3d(0,0,0) scale3d(1,1,1)",_.cloneImg.style.transform="translate3d(0,0,0) scale3d(1,1,1)",n.cloneImg.style.transition="",_.emptyPreviewDescriptionEl.classList.remove("gallery__preview-description--animate"),_.previewDescriptionEl.classList.remove("gallery__preview-description--animate"),_.emptyPreviewDescriptionEl.innerHTML="",_.emptyPreviewDescriptionEl.style.opacity="",_.emptyPreviewDescriptionEl.style.WebkitTransform="",_.emptyPreviewDescriptionEl.style.transform="",_.previewDescriptionEl.style.opacity="",_.previewDescriptionEl.style.WebkitTransform="",_.previewDescriptionEl.style.transform="",_.isAnimating=!1})["catch"](function(i){console.error(i)})}}}function x(i){for(var t=i;t=t.nextElementSibling;)if(t.getAttribute("data-size"))return t;return null}function w(i){for(var t=i;t=t.previousElementSibling;)if(t.getAttribute("data-size"))return t;return null}function E(i){x(i)?this.nextBtn.classList.remove("gallery__preview-btn--disabled"):this.nextBtn.classList.add("gallery__preview-btn--disabled"),w(i)?this.previousBtn.classList.remove("gallery__preview-btn--disabled"):this.previousBtn.classList.add("gallery__preview-btn--disabled")}function b(){return{width:document.documentElement.clientWidth,height:window.innerHeight}}function P(){_()}function _(){s(".js-gallery",{imgPositions:[{pos:{x:1,y:-.5},pagemargin:30},{mq:"48em",pos:{x:-.5,y:1},pagemargin:30}],sizes:[{columns:2,gutter:15},{mq:"560px",columns:2,gutter:15},{mq:"768px",columns:3,gutter:15},{mq:"920px",columns:4,gutter:15},{mq:"1180px",columns:5,gutter:15}]})}var z=["webkitTransitionEnd","transitionend","msTransitionEnd","oTransitionEnd"],L=function(){function i(i,t){return o[i]=o[i]||[],o[i].push(t),this}function t(t,e){return e._once=!0,i(t,e),this}function e(i){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?o[i].splice(o[i].indexOf(t),1):delete o[i],this}function s(i){for(var t=this,s=arguments.length,n=Array(s>1?s-1:0),r=1;r<s;r++)n[r-1]=arguments[r];var a=o[i]&&o[i].slice();return a&&a.forEach(function(s){s._once&&e(i,s),s.apply(t,n)}),this}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o={},r=n;return r.on=i,r.ounce=t,r.off=e,r.emit=s,r},k=function(){function i(i){i.forEach(function(i){return i()})}function t(i){return Array.prototype.slice.call(document.querySelectorAll(i))}function e(i){return Array.apply(null,Array(i)).map(function(){return 0})}function s(){return k.map(function(i){return i.mq&&window.matchMedia("(min-width: "+i.mq+")").matches}).indexOf(!0)}function n(){I=s()}function o(){x=I===-1?k[k.length-1]:k[I]}function r(){w=e(x.columns)}function a(){E=t(y?M["new"]:M.all)}function l(){0!==E.length&&(b=E[0].clientWidth,P=E.map(function(i){return i.clientHeight}))}function h(){E.forEach(function(i,t){var e=w.indexOf(Math.min.apply(Math,w));i.style.position="absolute",i.style.top=w[e]+"px",i.style.left=e*b+e*x.gutter+"px",i.setAttribute(z,""),w[e]+=P[t]+x.gutter})}function c(){_.style.position="relative",_.style.width=x.columns*b+(x.columns-1)*x.gutter+"px",_.style.height=Math.max.apply(Math,w)-x.gutter+"px"}function m(){v||(requestAnimationFrame(p),v=!0)}function p(){I!==s()&&(g(),q.emit("resize",x)),v=!1}function g(){return y=!1,i(A.concat(D)),q.emit("pack")}function d(){return y=!0,i(D),q.emit("update")}function u(){var i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=i?"addEventListener":"removeEventListener";return window[t]("resize",m),q}var f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},y=void 0,v=void 0,I=void 0,x=void 0,w=void 0,E=void 0,b=void 0,P=void 0,_=document.querySelector(f.container),z=0===f.packed.indexOf("data-")?f.packed:"data-"+f.packed,k=f.sizes.slice().reverse(),M={all:f.container+" > *","new":f.container+" > *:not(["+z+"])"},A=[n,o,r],D=[a,l,h,c],q=L({pack:g,update:d,resize:u});return q},M={setup:n,init:o,openItem:c,closeItem:f,nextItem:y,previousItem:v},A={imgPositions:[{pos:{x:1,y:1},pagemargin:0}],sizes:[{columns:1,gutter:30},{mq:"1024px",columns:5,gutter:30}]};"loading"!=document.readyState?P():document.addEventListener("DOMContentLoaded",P)}();
//# sourceMappingURL=main.min.js.map
